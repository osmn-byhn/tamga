var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},s=(n,r,a)=>(a=n==null?{}:e(i(n)),o(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));let c=require(`electron`),l=require(`node:url`),u=require(`node:path`);u=s(u),require(`node:fs`);var d=typeof __dirname<`u`?__dirname:u.default.dirname((0,l.fileURLToPath)({}.url));c.app.setName(`Tamga`),u.default.join(c.app.getPath(`userData`),`vault.dat`),process.env.APP_ROOT=u.default.join(d,`../`);const f=u.default.join(process.env.APP_ROOT,`dist-electron`),p=u.default.join(process.env.APP_ROOT,`dist`),m=process.env.VITE_DEV_SERVER_URL;process.env.VITE_PUBLIC=m?u.default.join(process.env.APP_ROOT,`public`):p,process.platform===`win32`&&c.app.disableHardwareAcceleration(),process.platform===`win32`&&c.app.setAppUserModelId(c.app.getName()),c.Menu.setApplicationMenu(null),c.app.requestSingleInstanceLock()||(c.app.quit(),process.exit(0));var h=null,g=u.default.join(d,`preload.cjs`),_=u.default.join(p,`index.html`);async function v(){let e=u.default.join(process.env.VITE_PUBLIC,`tamga.ico`),t=c.nativeImage.createFromPath(e);console.log(`Setting window icon from:`,e),console.log(`Icon image size:`,t.getSize()),console.log(`Icon image is empty:`,t.isEmpty()),h=new c.BrowserWindow({title:`Tamga`,width:1200,height:800,icon:t,autoHideMenuBar:!0,webPreferences:{preload:g,nodeIntegration:!1,contextIsolation:!0,webSecurity:!1}}),t.isEmpty()||setTimeout(()=>{h&&h.setIcon(t)},500),h.webContents.session.setDisplayMediaRequestHandler((e,t)=>{import(`electron`).then(({desktopCapturer:e})=>{e.getSources({types:[`screen`]}).then(e=>{e.length>0?t({video:e[0],audio:`loopback`}):t(null)})})}),h.webContents.on(`did-finish-load`,()=>{h?.webContents.send(`main-process-message`,new Date().toLocaleString())}),h.webContents.on(`did-fail-load`,(e,t,n,r)=>{console.error(`Failed to load:`,t,n,r)}),h.webContents.on(`console-message`,(e,t,n)=>{console.log(`Renderer console:`,t,n)});let n=process.env.VITE_DEV_SERVER_URL||`http://localhost:5173`;if(process.env.NODE_ENV===`development`||m)try{console.log(`Loading from dev server:`,n),await h.loadURL(n)}catch(e){console.error(`Failed to load from dev server, trying file:`,e),h.loadFile(_)}else console.log(`Loading from file:`,_),h.loadFile(_)}c.app.whenReady().then(v),c.app.on(`window-all-closed`,()=>{h=null,process.platform!==`darwin`&&c.app.quit()}),c.app.on(`second-instance`,()=>{h&&(h.isMinimized()&&h.restore(),h.focus())}),c.app.on(`activate`,()=>{let e=c.BrowserWindow.getAllWindows();e.length?e[0].focus():v()}),exports.MAIN_DIST=f,exports.RENDERER_DIST=p,exports.VITE_DEV_SERVER_URL=m;